PROGRAM GETDATAFORPLOTTING
IMPLICIT NONE
!--------PARAMETERS OF MODLE (INPUT DATA)----------------
INTEGER, PARAMETER :: NT=2880,NZ=34,NX=1200,NXL=200,DT=15  ! DT OUTPUT INTERVAL TIMESTEP
INTEGER, PARAMETER :: ND=30,NDT=24*60/DT
INTEGER, PARAMETER :: NBIN=100  ! BINS FOR CLOUD WATER CONTENT
INTEGER, PARAMETER :: NZZ=52  ! BINS FOR CLOUD WATER CONTENT
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
REAL DEN(NZZ),QRL(NX,NZZ),QRS(NX,NZZ),TC(NX,NZZ)
REAL OMG(NX,NZZ),MAXOMG(NX,2)
REAL PRECI(NX+2),PBL(NX+2),FSH(NX+2),FLH(NX+2)
REAL QC(NX,NZZ),QA(NX,NZZ),QB(NX,NZZ),QR(NX,NZZ)
REAL DWQ(NX,NZZ),DWT(NX,NZZ),QV(NX,NZZ)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
! THRESHOLD VALUES SETTINGS  -----------------------------
REAL QCC , QCE , CWP ! LOW LIMIT FOR CONVECTION CLOUD (G/KG)! LOW LIMIT FOR CLOUD ENSEMBLE (G/KG)! CLOUD WATER PATH THRESHOLD (G/M2)                   
                                ! --IF CWP>0 THEN QC0=CWP/(D DZ) ELSE =QCC                                ! --QC0 IS USED FOR CLOUD IDENTIFICATION
DATA QCC,QCE,CWP/1.0E-2,1.0E-4,0.2/
DATA ZDAT/ 0.0500000, 0.1643000, 0.3071000, 0.4786000            &
    &    , 0.6786000, 0.9071000, 1.1640000, 1.4500000, 1.7640001 &
    &    , 2.1070001, 2.4790001, 2.8789999, 3.3069999, 3.7639999 &
    &    , 4.2500000, 4.7639999, 5.3070002, 5.8790002, 6.4790001 &
    &    , 7.1069999, 7.7639999, 8.4499998, 9.1639996, 9.9069996 &
    &    ,10.6800003,11.4799995,12.3100004,13.1599998,14.0500002 &
    &    ,14.9600000,15.9099998,16.8799992,17.8799992,18.9099998/
!=========================================================================
INTEGER I,J,K,IK,IX,IZ,IG,IT
CHARACTER*100 FPATH,DIRINH,DIRINL,DIROUT
CHARACTER FOLD*30,CASENM(6)*20,REGNM*20,ADDSTR*5
CHARACTER DATESTR(6)*8


CASENM(1)="ETPCTR_H"  ; DATESTR(1)='20100603'
CASENM(2)="WTPCTR_H"  ; DATESTR(2)='20100703'
CASENM(3)="NPCCTR_H"  ; DATESTR(3)='20100802'
CASENM(4)="NECCTR_H"  ; DATESTR(4)='20120706'
CASENM(5)="MLYRCTR_H" ; DATESTR(5)='20100602'
CASENM(6)="PRDCTR_H"  ; DATESTR(6)='20120401'
DIRIN="Z:\CRM\500m\"
DIROUT="Z:\CRM\500m\Postdata\"

DO IG=1,6
	IF (CASENM(IG)(1:3)=="MLY") THEN
		REGNM=CASENM(IG)(1:4)
	ELSE
		REGNM=CASENM(IG)(1:3)
	ENDIF
	FPATH=TRIM(DIRINH)//TRIM(REGNM)//'\run\postdata\' &
   &   //TRIM(CASENM(I))//'_omega_2880X1200X52.binary'
	OPEN(20,FILE=TRIM(FPATH),FORM='binary')
    FPATH=TRIM(DIRINH)//TRIM(REGNM)//'\run\postdata\' &
   &   //TRIM(CASENM(I))//'_rlw_2880X1200X52.binary'
    OPEN(21,FILE=TRIM(FPATH),FORM='binary')
    FPATH=TRIM(DIRINH)//TRIM(REGNM)//'\run\postdata\' &
   &   //TRIM(CASENM(I))//'_rsw_2880X1200X52.binary'
    OPEN(22,FILE=TRIM(FPATH),FORM='binary')
    FPATH=TRIM(DIRINH)//TRIM(REGNM)//'\run\postdata\' &
   &   //TRIM(CASENM(I))//'_qa_2880X1200X52.binary'
    OPEN(23,FILE=TRIM(FPATH),FORM='binary')
    FPATH=TRIM(DIRINH)//TRIM(REGNM)//'\run\postdata\' &
   &   //TRIM(CASENM(I))//'_qb_2880X1200X52.binary'
    OPEN(24,FILE=TRIM(FPATH),FORM='binary')
    FPATH=TRIM(DIRINH)//TRIM(REGNM)//'\run\postdata\' &
   &   //TRIM(CASENM(I))//'_qc_2880X1200X52.binary'
    OPEN(25,FILE=TRIM(FPATH),FORM='binary')
    FPATH=TRIM(DIRINH)//TRIM(REGNM)//'\run\postdata\' &
   &   //TRIM(CASENM(I))//'_qr_2880X1200X52.binary'
    OPEN(26,FILE=TRIM(FPATH),FORM='binary')
    FPATH=TRIM(DIRINH)//TRIM(REGNM)//'\run\postdata\' &
   &   //TRIM(CASENM(I))//'_den_2880X52.binary'
    OPEN(27,FILE=TRIM(FPATH),FORM='binary')
    FPATH=TRIM(DIRINH)//TRIM(REGNM)//'\run\postdata\' &
   &   //TRIM(CASENM(I))//'_tc_2880X1200X52.binary'
    OPEN(28,FILE=TRIM(FPATH),FORM='binary')
!
    FPATH=TRIM(DIRINH)//TRIM(REGNM)//'\run\postdata\'  &
   &   //'PRECI_'//TRIM(CASENM(I))//'.TXT'
    OPEN(30,FILE=TRIM(FPATH))
    DO IX=1,NX
        READ(20)OMGH(IX,:)
        READ(21)QRLH(IX,:)
        READ(22)QRSH(IX,:)
        READ(23)QAH(IX,:)
        READ(24)QBH(IX,:)
        READ(25)QCH(IX,:)
        READ(26)QRH(IX,:)
        READ(28)TCH(IX,:)
    ENDDO
    READ(27)DENH(:)
    READ(30,'(8e12.4)')PRECIH,PBLH,FSHH,FLHH
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!